----------------------------
Doing the following analysis: 
FuelScen_carbontaxhigh_emissioncap
----------------------------
test
Reading data...
Reading and constructing data
Transport demand in the base year 2018 (in MTonnes):
             product  tot_weight
0           Dry bulk          95
1   Container (fast)         4.1
2   Container (slow)         9.2
3  Break bulk (fast)          12
4  Break bulk (slow)          15
5           Neo bulk          19
Done reading data.
Time used reading the base data: 35.86032176017761
Constructing SP model...
Done constructing model.
Time used constructing the model: 235.31838130950928
----------
Solving model...
Using license file C:\Users\steffejb\gurobi.lic
Academic license - for non-commercial use only
Read LP format model from file C:\Users\steffejb\OneDrive - NTNU\Work\GitHub\STraM_ntnu_development\temp\pyomo\tmphhsuvbsp.pyomo.lp
Reading time = 39.60 seconds
x2706734: 4562462 rows, 1834202 columns, 26058728 nonzeros
Changed value of parameter FeasibilityTol to 0.01
   Prev: 1e-06  Min: 1e-09  Max: 0.01  Default: 1e-06
Changed value of parameter MIPGap to 0.005
   Prev: 0.0001  Min: 0.0  Max: inf  Default: 0.0001
Changed value of parameter NumericFocus to 1
   Prev: 0  Min: 0  Max: 3  Default: 0
Parameter BarConvTol unchanged
   Value: 1e-08  Min: 0.0  Max: 1.0  Default: 1e-08
Parameter Crossover unchanged
   Value: -1  Min: -1  Max: 5  Default: -1
Parameter Method unchanged
   Value: -1  Min: -1  Max: 5  Default: -1
Parameter NodeMethod unchanged
   Value: -1  Min: -1  Max: 2  Default: -1
Gurobi Optimizer version 9.0.0 build v9.0.0rc2 (win64)
Optimize a model with 4562462 rows, 1834202 columns and 26058728 nonzeros
Model fingerprint: 0x0b365bba
Variable types: 1833896 continuous, 306 integer (306 binary)
Coefficient statistics:
  Matrix range     [6e-06, 1e+03]
  Objective range  [8e-02, 3e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-04, 9e+01]
Presolve removed 27911 rows and 136 columns (presolve time = 6s) ...
Presolve removed 4361555 rows and 1034817 columns (presolve time = 10s) ...
Presolve removed 4431777 rows and 1034817 columns (presolve time = 17s) ...
Presolve removed 4434388 rows and 1041547 columns (presolve time = 20s) ...
Presolve removed 4455062 rows and 1055663 columns (presolve time = 25s) ...
Presolve removed 4466636 rows and 1120263 columns (presolve time = 30s) ...
Presolve removed 4466987 rows and 1134989 columns (presolve time = 35s) ...
Presolve removed 4467405 rows and 1135008 columns (presolve time = 40s) ...
Presolve removed 4467520 rows and 1135456 columns (presolve time = 45s) ...
Presolve removed 4467520 rows and 1135456 columns (presolve time = 50s) ...
Presolve removed 4467520 rows and 1135456 columns (presolve time = 55s) ...
Presolve removed 4467520 rows and 1135456 columns (presolve time = 61s) ...
Presolve removed 4467520 rows and 1135456 columns
Presolve time: 61.41s
Presolved: 94942 rows, 698746 columns, 9076451 nonzeros
Variable types: 698712 continuous, 34 integer (34 binary)

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.49s

Barrier statistics:
 AA' NZ     : 4.320e+06
 Factor NZ  : 1.080e+07 (roughly 400 MBytes of memory)
 Factor Ops : 2.730e+09 (roughly 2 seconds per iteration)
 Threads    : 1

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.02880151e+11 -6.82211809e+10  2.01e+09 8.32e+01  9.19e+07    99s
   1   2.60024765e+11 -6.28310106e+10  1.29e+09 1.81e+02  6.05e+07   102s
   2   1.42220746e+11 -4.45954831e+10  7.07e+08 9.20e+01  3.38e+07   104s
   3   2.61602049e+10 -2.63644444e+10  1.30e+08 2.67e+01  6.88e+06   106s
   4   7.24914852e+09 -1.60119515e+10  3.34e+07 6.24e+00  1.79e+06   109s
   5   5.59720746e+09 -1.58392287e+10  2.46e+07 6.10e+00  1.34e+06   112s
   6   2.63989720e+09 -1.15150818e+10  9.06e+06 3.50e+00  5.27e+05   114s
   7   1.04443850e+09 -7.40081134e+09  1.48e+06 2.08e+00  1.08e+05   117s
   8   6.91702815e+08 -3.40800427e+09  3.88e+05 8.59e-01  3.34e+04   120s
   9   4.99717965e+08 -1.44993820e+09  9.05e+04 2.91e-01  9.56e+03   122s
  10   4.30385053e+08 -8.76526730e+08  5.71e+04 1.49e-01  5.60e+03   124s
  11   3.78136749e+08 -8.24631396e+08  3.57e+04 1.37e-01  4.17e+03   126s
  12   3.31254541e+08 -5.52549493e+08  2.46e+04 8.07e-02  2.71e+03   128s
  13   2.70725178e+08 -3.33567364e+08  1.70e+04 3.91e-02  1.65e+03   130s
  14   2.22218370e+08 -2.11652190e+08  1.22e+04 1.94e-02  1.08e+03   133s
  15   9.97256740e+07 -1.50959279e+08  3.65e+03 1.14e-02  4.28e+02   136s
  16   3.13198203e+07 -5.29996103e+07  8.97e+02 2.80e-03  1.14e+02   139s
  17   1.14269118e+07 -1.84887398e+07  2.84e+02 8.15e-04  3.66e+01   142s
  18   4.62664888e+06 -7.46198702e+06  1.01e+02 2.69e-04  1.37e+01   146s
  19   1.33845136e+06 -2.96033338e+06  2.44e+01 9.06e-05  4.21e+00   149s
  20   6.23029726e+05 -2.06387904e+06  1.01e+01 6.16e-05  2.39e+00   152s
  21   4.70640996e+05 -1.26836264e+06  7.31e+00 3.47e-05  1.54e+00   155s
  22   1.73037036e+05 -8.60476754e+05  2.38e+00 2.18e-05  8.40e-01   158s
  23   1.02395319e+05 -4.71430980e+05  1.22e+00 1.08e-05  4.55e-01   162s
  24   7.66501826e+04 -3.43153618e+05  8.47e-01 7.41e-06  3.28e-01   165s
  25   5.22164666e+04 -2.57438735e+05  5.04e-01 5.26e-06  2.37e-01   168s
  26   3.93874970e+04 -1.69028866e+05  3.37e-01 3.25e-06  1.58e-01   172s
  27   3.43916775e+04 -1.55553583e+05  2.77e-01 2.97e-06  1.43e-01   175s
  28   2.60167300e+04 -1.26154111e+05  1.80e-01 2.39e-06  1.14e-01   178s
  29   2.29358994e+04 -1.02052305e+05  1.48e-01 1.92e-06  9.31e-02   182s
  30   1.95780940e+04 -7.43351384e+04  1.15e-01 1.36e-06  6.97e-02   186s
  31   1.61699119e+04 -6.06871415e+04  8.38e-02 1.08e-06  5.68e-02   189s
  32   1.42879808e+04 -3.79321087e+04  6.79e-02 6.53e-07  3.86e-02   193s
  33   1.11194639e+04 -2.76502441e+04  4.28e-02 4.72e-07  2.85e-02   197s
  34   9.52260657e+03 -1.70322076e+04  3.17e-02 2.85e-07  1.95e-02   200s
  35   8.26957075e+03 -1.16716836e+04  2.36e-02 1.94e-07  1.46e-02   204s
  36   7.45458215e+03 -9.64291827e+03  1.85e-02 1.74e-07  1.25e-02   208s
  37   7.25657832e+03 -8.06454995e+03  1.73e-02 1.77e-07  1.12e-02   211s
  38   7.14273706e+03 -6.81408175e+03  1.66e-02 1.80e-07  1.02e-02   214s
  39   7.04907712e+03 -5.77664933e+03  1.60e-02 1.74e-07  9.39e-03   217s
  40   6.79856824e+03 -4.66303799e+03  1.45e-02 1.74e-07  8.39e-03   220s
  41   6.52358690e+03 -3.41845472e+03  1.29e-02 1.68e-07  7.28e-03   224s
  42   6.12968817e+03 -1.87670966e+03  1.06e-02 1.47e-07  5.86e-03   227s
  43   6.02292993e+03 -1.42178521e+03  1.00e-02 1.39e-07  5.45e-03   230s
  44   5.59233448e+03 -5.09650032e+02  7.64e-03 1.23e-07  4.46e-03   233s
  45   5.49119171e+03 -1.95644724e+02  7.09e-03 1.13e-07  4.15e-03   236s
  46   5.21061889e+03  2.02903574e+02  5.60e-03 9.92e-08  3.65e-03   239s
  47   5.00517485e+03  5.89675162e+02  4.48e-03 8.49e-08  3.22e-03   243s
  48   4.96153621e+03  1.40432079e+03  4.25e-03 6.22e-08  2.59e-03   246s
  49   4.83759401e+03  1.64621590e+03  3.63e-03 5.84e-08  2.33e-03   250s
  50   4.67051055e+03  1.94105596e+03  2.78e-03 5.47e-08  1.99e-03   253s
  51   4.62813025e+03  2.13777941e+03  2.57e-03 5.18e-08  1.81e-03   256s
  52   4.54247019e+03  2.41555405e+03  2.14e-03 4.83e-08  1.55e-03   258s
  53   4.49363188e+03  2.73564010e+03  1.91e-03 4.30e-08  1.28e-03   261s
  54   4.39264057e+03  2.86842782e+03  1.45e-03 4.40e-08  1.11e-03   265s
  55   4.30948014e+03  3.14077056e+03  1.08e-03 4.50e-08  8.49e-04   268s
  56   4.27319080e+03  3.33129177e+03  9.30e-04 4.59e-08  6.84e-04   270s
  57   4.18911986e+03  3.45479473e+03  5.95e-04 4.61e-08  5.32e-04   273s
  58   4.15330860e+03  3.54161206e+03  4.63e-04 4.97e-08  4.43e-04   275s
  59   4.13144698e+03  3.63981523e+03  3.85e-04 4.64e-08  3.56e-04   278s
  60   4.10333991e+03  3.76794893e+03  2.89e-04 4.28e-08  2.43e-04   280s
  61   4.07713017e+03  3.83998164e+03  2.04e-04 4.12e-08  1.71e-04   283s
  62   4.06402360e+03  3.87493630e+03  1.65e-04 3.93e-08  1.36e-04   285s
  63   4.04506877e+03  3.89408116e+03  1.07e-04 3.52e-08  1.09e-04   288s
  64   4.03481922e+03  3.92237666e+03  7.85e-05 3.59e-08  8.10e-05   291s
  65   4.02709456e+03  3.95326063e+03  5.65e-05 3.43e-08  5.31e-05   295s
  66   4.01784252e+03  3.96277053e+03  3.10e-05 3.38e-08  3.95e-05   297s
  67   4.01512167e+03  3.97741728e+03  2.46e-05 2.71e-08  2.70e-05   299s
  68   4.01247534e+03  3.98662789e+03  3.05e-05 2.31e-08  1.84e-05   302s
  69   4.00788397e+03  3.99257531e+03  1.10e-05 1.84e-08  1.08e-05   304s
  70   4.00658556e+03  3.99722550e+03  5.58e-06 1.77e-08  6.54e-06   307s
  71   4.00593048e+03  3.99900982e+03  2.70e-06 1.85e-08  4.78e-06   309s
  72   4.00553580e+03  4.00005380e+03  1.56e-06 1.85e-08  3.74e-06   311s
  73   4.00538354e+03  4.00101380e+03  1.12e-06 1.78e-08  2.94e-06   313s
  74   4.00530288e+03  4.00180150e+03  1.20e-05 1.74e-08  2.32e-06   315s
  75   4.00517560e+03  4.00282288e+03  3.32e-05 1.59e-08  1.49e-06   317s
  76   4.00503222e+03  4.00343313e+03  1.54e-05 1.54e-08  9.45e-07   320s
  77   4.00495579e+03  4.00385802e+03  6.64e-06 1.55e-08  5.85e-07   323s
  78   4.00491258e+03  4.00410293e+03  2.87e-06 1.57e-08  3.79e-07   325s
  79   4.00490426e+03  4.00423135e+03  2.25e-06 1.58e-08  2.76e-07   327s
  80   4.00488762e+03  4.00431816e+03  1.21e-06 1.59e-08  2.02e-07   329s
  81   4.00487705e+03  4.00437917e+03  4.66e-07 1.59e-08  1.52e-07   331s
  82   4.00486620e+03  4.00448128e+03  3.63e-05 1.61e-08  7.24e-08   333s
  83   4.00486366e+03  4.00451859e+03  2.71e-05 1.61e-08  4.38e-08   336s
  84   4.00486350e+03  4.00451944e+03  2.67e-05 1.61e-08  4.31e-08   338s
  85   4.00486332e+03  4.00452022e+03  2.65e-05 1.60e-08  4.24e-08   340s
  86   4.00486307e+03  4.00452123e+03  2.74e-05 1.60e-08  4.15e-08   342s
  87   4.00486115e+03  4.00452938e+03  2.18e-05 1.60e-08  3.44e-08   344s
  88   4.00485472e+03  4.00455150e+03  2.72e-06 1.62e-08  1.53e-08   347s
  89   4.00485351e+03  4.00456404e+03  1.74e-06 1.61e-08  5.65e-09   349s
  90   4.00485109e+03  4.00456546e+03  4.18e-07 1.61e-08  4.03e-09   352s
  91   4.00485092e+03  4.00456735e+03  1.06e-06 1.61e-08  2.66e-09   354s
  92   4.00485088e+03  4.00456740e+03  1.04e-06 1.61e-08  2.56e-09   356s
  93   4.00485087e+03  4.00456740e+03  1.06e-06 1.61e-08  2.56e-09   359s
  94   4.00485042e+03  4.00456743e+03  7.32e-07 1.61e-08  2.65e-09   362s
  95   4.00484985e+03  4.00457032e+03  5.77e-07 1.61e-08  4.51e-10   364s
  96   4.00484963e+03  4.00457010e+03  5.70e-06 1.61e-08  3.89e-10   367s
  97   4.00484868e+03  4.00456984e+03  1.30e-05 1.61e-08  2.80e-10   369s
  98   4.00484800e+03  4.00456933e+03  9.24e-06 1.61e-08  1.33e-10   371s
  99   4.00484798e+03  4.00456892e+03  8.89e-06 1.61e-08  1.29e-10   374s
 100   4.00484795e+03  4.00456749e+03  8.52e-06 1.61e-08  1.26e-10   376s
 101   4.00484794e+03  4.00456669e+03  8.46e-06 1.59e-08  1.26e-10   378s
 102   4.00484793e+03  4.00456265e+03  8.37e-06 1.42e-08  1.25e-10   380s
 103   4.00484793e+03  4.00456249e+03  8.35e-06 1.41e-08  1.25e-10   383s
 104   4.00484793e+03  4.00456238e+03  8.34e-06 1.41e-08  1.25e-10   387s
 105   4.00484793e+03  4.00456187e+03  8.30e-06 1.41e-08  1.24e-10   391s
 106   4.00484793e+03  4.00456180e+03  8.30e-06 1.40e-08  1.24e-10   394s
 107   4.00484789e+03  4.00455371e+03  7.93e-06 1.32e-08  1.20e-10   398s
 108   4.00484788e+03  4.00455126e+03  7.73e-06 1.25e-08  1.17e-10   402s
 109   4.00484788e+03  4.00455110e+03  7.73e-06 1.25e-08  1.17e-10   406s

Barrier solved model in 109 iterations and 405.51 seconds
Optimal objective 4.00484868e+03


Root crossover log...

   90805 DPushes remaining with DInf 1.9585678e-04               407s
       0 DPushes remaining with DInf 9.0144160e-06               411s

    1200 PPushes remaining with PInf 2.3986291e+05               411s
      12 PPushes remaining with PInf 9.1377706e+04               411s

  Push phase complete: Pinf 9.1377706e+04, Dinf 8.4999986e+00    411s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22419    3.7395050e+03   0.000000e+00   9.627825e+00    411s
   26278    3.7394179e+03   0.000000e+00   3.449562e+02    416s
   29399    3.7393177e+03   0.000000e+00   2.610493e+00    420s
   32610    3.7390638e+03   1.825457e+04   0.000000e+00    426s
   35508    3.7413121e+03   8.601883e+02   0.000000e+00    431s
   37440    3.7416932e+03   3.816179e+01   0.000000e+00    436s
   37653    3.7416931e+03   0.000000e+00   0.000000e+00    438s
   38704    3.7416779e+03   0.000000e+00   1.454939e+00    441s
   39328    3.7416931e+03   0.000000e+00   0.000000e+00    443s
Extra 1675 simplex iterations after uncrush
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.741693e+03, 39328 iterations, 369.90 seconds

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3741.69307    0    4          - 3741.69307      -     -  444s
H    0     0                    3741.6950471 3741.69307  0.00%     -  446s

Explored 1 nodes (39328 simplex iterations) in 448.76 seconds
Thread count was 8 (of 8 available processors)

Solution count 1: 3741.7 

Optimal solution found (tolerance 5.00e-03)
Warning: max constraint violation (7.9710e-02) exceeds tolerance
Warning: max bound violation (7.2624e-02) exceeds tolerance
Best objective 3.741695047144e+03, best bound 3.741695047144e+03, gap 0.0000%
the solution is feasible and optimal
Solution time: 503.84987330436707
Done solving model.
Time used solving the model: 738.7590069770813
----------Dumping data in pickle file...done.
Dumping results in pickle file.....done.
objective function value:  3741.6950471439563
objective function value normalized (BILLION NOK):  3741.7
                      2023     2028      2034      2040      2050     
                      mean std mean  std mean  std mean  std mean  std
General                 43   0   53    0   61  1.9   67  1.8   74  2.3
General (Empty Trips)   16   0   12    0   13  1.3   15 0.58   15 0.44
Carbon                 6.5   0   10    0   11 0.04  7.5 0.01 0.02    0
Carbon (Empty Trips)   5.2   0  1.9    0  1.8  1.4 0.13    0    0    0
Time value              15   0   18    0   22 0.02   23 0.02   27 0.04
Transfer                22   0   28    0   33 0.06   31 0.05   33 0.31
Edge                   1.4   0    0    0    0    0    0    0    0    0
Node                  0.32   0 0.21    0   -0    0 0.03 0.01    0    0
Upgrade                  0   0    0    0    0    0    0    0    0    0
Charge                 4.7   0  4.5    0  3.6    0  4.5    0  3.1    0
discount_factor          1   1 0.83 0.83 0.66 0.66 0.53 0.53 0.36 0.36
emissions (MTonnes CO2 eq.):
             AvgEmission     Std  AvgEmission_perc  Std_perc
time_period                                                 
2023                  10       0             1e+02         0
2028                 5.3       0                51         0
2034                 3.1    0.47                30       4.5
2040                 1.1  0.0016                10     0.015
2050              0.0022 7.2e-05             0.021   0.00069
----------------
Average transport work in GTONNES*km:
    mode            product time_period  TransportArbeid
0   Rail           Dry bulk        2023               10
1   Rail           Neo bulk        2023         -9.3e-05
2   Road  Break bulk (fast)        2023                6
3   Road  Break bulk (slow)        2023              6.3
4   Road   Container (fast)        2023              2.7
5   Road   Container (slow)        2023              3.8
6   Road           Dry bulk        2023             0.57
7   Road           Neo bulk        2023               13
8    Sea  Break bulk (fast)        2023             0.12
9    Sea  Break bulk (slow)        2023              1.5
10   Sea   Container (fast)        2023             0.16
11   Sea   Container (slow)        2023              1.2
12   Sea           Dry bulk        2023               99
13   Sea           Neo bulk        2023             0.28

