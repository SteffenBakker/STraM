----------------------------
Doing the following analysis: 
FuelScen_carbontaxbase_emissioncap
----------------------------
test
Reading data...
Reading and constructing data
Transport demand in the base year 2018 (in MTonnes):
             product  tot_weight
0           Dry bulk          95
1   Container (fast)         4.1
2   Container (slow)         9.2
3  Break bulk (fast)          12
4  Break bulk (slow)          15
5           Neo bulk          19
Done reading data.
Time used reading the base data: 59.81706643104553
Constructing SP model...
Done constructing model.
Time used constructing the model: 225.97164034843445
----------
Solving model...
Using license file C:\Users\steffejb\gurobi.lic
Academic license - for non-commercial use only
Read LP format model from file C:\Users\steffejb\OneDrive - NTNU\Work\GitHub\STraM_ntnu_development\temp\pyomo\tmpg7swinwh.pyomo.lp
Reading time = 37.03 seconds
x2706734: 4562462 rows, 1834202 columns, 26047586 nonzeros
Changed value of parameter FeasibilityTol to 0.01
   Prev: 1e-06  Min: 1e-09  Max: 0.01  Default: 1e-06
Changed value of parameter MIPGap to 0.002
   Prev: 0.0001  Min: 0.0  Max: inf  Default: 0.0001
Changed value of parameter NumericFocus to 1
   Prev: 0  Min: 0  Max: 3  Default: 0
Parameter BarConvTol unchanged
   Value: 1e-08  Min: 0.0  Max: 1.0  Default: 1e-08
Parameter Crossover unchanged
   Value: -1  Min: -1  Max: 5  Default: -1
Parameter Method unchanged
   Value: -1  Min: -1  Max: 5  Default: -1
Parameter NodeMethod unchanged
   Value: -1  Min: -1  Max: 2  Default: -1
Gurobi Optimizer version 9.0.0 build v9.0.0rc2 (win64)
Optimize a model with 4562462 rows, 1834202 columns and 26047586 nonzeros
Model fingerprint: 0x03728df8
Variable types: 1833896 continuous, 306 integer (306 binary)
Coefficient statistics:
  Matrix range     [6e-06, 1e+03]
  Objective range  [8e-02, 3e-01]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-04, 9e+01]
Presolve removed 9 rows and 0 columns (presolve time = 5s) ...
Presolve removed 4311209 rows and 952118 columns (presolve time = 11s) ...
Presolve removed 4431777 rows and 1034817 columns (presolve time = 19s) ...
Presolve removed 4432841 rows and 1040000 columns (presolve time = 21s) ...
Presolve removed 4434388 rows and 1041547 columns (presolve time = 25s) ...
Presolve removed 4466636 rows and 1116655 columns (presolve time = 30s) ...
Presolve removed 4466987 rows and 1134989 columns (presolve time = 35s) ...
Presolve removed 4467405 rows and 1135341 columns (presolve time = 40s) ...
Presolve removed 4467520 rows and 1135456 columns (presolve time = 45s) ...
Presolve removed 4467520 rows and 1135456 columns (presolve time = 50s) ...
Presolve removed 4467520 rows and 1135456 columns (presolve time = 57s) ...
Presolve removed 4467520 rows and 1135456 columns
Presolve time: 59.13s
Presolved: 94942 rows, 698746 columns, 9076451 nonzeros
Variable types: 698712 continuous, 34 integer (34 binary)

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.89s

Barrier statistics:
 AA' NZ     : 4.320e+06
 Factor NZ  : 1.080e+07 (roughly 400 MBytes of memory)
 Factor Ops : 2.730e+09 (less than 1 second per iteration)
 Threads    : 1

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   4.02870743e+11 -6.82211779e+10  2.00e+09 8.32e+01  9.19e+07    94s
   1   2.59096645e+11 -6.55078929e+10  1.29e+09 1.91e+02  6.04e+07    97s
   2   1.25780258e+11 -5.62417171e+10  6.24e+08 1.51e+02  3.06e+07    99s
   3   3.19488310e+10 -3.21536251e+10  1.58e+08 5.20e+01  8.45e+06   102s
   4   7.85605459e+09 -1.75956266e+10  3.61e+07 1.04e+01  2.10e+06   105s
   5   6.09295867e+09 -1.74427122e+10  2.68e+07 1.02e+01  1.59e+06   107s
   6   2.81520229e+09 -1.27614014e+10  9.77e+06 5.98e+00  6.27e+05   110s
   7   1.66086030e+09 -1.09613678e+10  3.99e+06 5.11e+00  2.87e+05   113s
   8   1.05191584e+09 -6.83560092e+09  1.17e+06 2.91e+00  1.04e+05   116s
   9   7.71246596e+08 -3.00892954e+09  2.91e+05 1.06e+00  3.09e+04   118s
  10   6.23817514e+08 -1.33262360e+09  1.09e+05 3.57e-01  1.18e+04   120s
  11   5.45951485e+08 -9.76267987e+08  7.31e+04 2.31e-01  7.85e+03   122s
  12   5.20041643e+08 -9.48963535e+08  6.11e+04 2.23e-01  6.95e+03   124s
  13   4.24828580e+08 -6.61287849e+08  2.97e+04 1.32e-01  3.76e+03   126s
  14   3.46792113e+08 -4.62758435e+08  1.69e+04 7.86e-02  2.22e+03   128s
  15   3.07577314e+08 -3.80378822e+08  1.32e+04 5.97e-02  1.72e+03   131s
  16   1.78078684e+08 -2.04347887e+08  3.40e+03 2.44e-02  6.15e+02   133s
  17   7.89620611e+07 -1.11463684e+08  1.15e+03 1.17e-02  2.50e+02   136s
  18   2.45694472e+07 -3.89465692e+07  2.45e+02 3.35e-03  6.92e+01   139s
  19   1.02007135e+07 -1.36176357e+07  9.40e+01 1.01e-03  2.45e+01   141s
  20   5.62062758e+06 -8.45549818e+06  4.86e+01 5.86e-04  1.39e+01   144s
  21   2.09900439e+06 -3.56308329e+06  1.55e+01 2.31e-04  5.21e+00   147s
  22   8.73046225e+05 -1.71856515e+06  5.20e+00 9.79e-05  2.23e+00   150s
  23   6.71823206e+05 -1.03460143e+06  3.94e+00 5.56e-05  1.46e+00   153s
  24   2.17464918e+05 -5.84671475e+05  1.06e+00 2.99e-05  6.40e-01   155s
  25   1.30485003e+05 -4.26491965e+05  5.81e-01 2.13e-05  4.34e-01   158s
  26   1.18715996e+05 -3.88281609e+05  5.19e-01 1.91e-05  3.93e-01   161s
  27   8.49956850e+04 -2.87365507e+05  3.48e-01 1.32e-05  2.85e-01   163s
  28   5.90882061e+04 -1.76406949e+05  2.23e-01 7.49e-06  1.78e-01   166s
  29   4.11974926e+04 -1.21089477e+05  1.41e-01 4.79e-06  1.22e-01   170s
  30   3.47744415e+04 -9.96998407e+04  1.15e-01 3.72e-06  1.00e-01   174s
  31   2.95573987e+04 -7.39379630e+04  9.39e-02 2.41e-06  7.70e-02   177s
  32   2.25343769e+04 -5.61384125e+04  6.52e-02 1.51e-06  5.82e-02   180s
  33   1.92077969e+04 -3.89106810e+04  5.24e-02 9.34e-07  4.29e-02   183s
  34   1.34671113e+04 -2.64251068e+04  3.10e-02 5.93e-07  2.93e-02   186s
  35   1.19902868e+04 -1.81999998e+04  2.58e-02 3.97e-07  2.22e-02   189s
  36   9.75586614e+03 -1.46642380e+04  1.81e-02 3.21e-07  1.79e-02   191s
  37   8.22698036e+03 -9.18914518e+03  1.27e-02 2.02e-07  1.28e-02   195s
  38   7.40932337e+03 -5.71417854e+03  9.89e-03 1.74e-07  9.60e-03   197s
  39   7.29969703e+03 -5.47752897e+03  9.52e-03 1.78e-07  9.35e-03   201s
  40   7.17956158e+03 -4.43618891e+03  9.11e-03 1.78e-07  8.50e-03   203s
  41   6.86596817e+03 -3.13436799e+03  8.13e-03 1.87e-07  7.31e-03   206s
  42   6.55394713e+03 -2.42795460e+03  7.11e-03 1.85e-07  6.57e-03   209s
  43   6.19027774e+03 -1.72823977e+03  5.92e-03 1.88e-07  5.78e-03   212s
  44   5.97707590e+03 -1.08855361e+03  5.24e-03 1.86e-07  5.16e-03   215s
  45   5.67609823e+03 -5.74479226e+02  4.25e-03 1.80e-07  4.56e-03   218s
  46   5.44685235e+03 -8.62129591e+00  3.50e-03 1.73e-07  3.98e-03   221s
  47   5.23519687e+03  4.83735440e+02  2.81e-03 1.60e-07  3.46e-03   224s
  48   5.17620446e+03  9.46278021e+02  2.62e-03 1.41e-07  3.08e-03   227s
  49   5.07417731e+03  1.33803246e+03  2.30e-03 1.28e-07  2.72e-03   229s
  50   4.97828618e+03  1.50703609e+03  2.01e-03 1.22e-07  2.53e-03   232s
  51   4.80789246e+03  1.79374737e+03  1.50e-03 1.14e-07  2.19e-03   234s
  52   4.74300920e+03  2.06046242e+03  1.31e-03 1.04e-07  1.95e-03   237s
  53   4.68352875e+03  2.43922591e+03  1.13e-03 9.01e-08  1.63e-03   239s
  54   4.65479824e+03  2.53079783e+03  1.05e-03 8.70e-08  1.54e-03   241s
  55   4.59297324e+03  2.74890588e+03  8.86e-04 7.87e-08  1.34e-03   244s
  56   4.50935493e+03  2.88142670e+03  6.66e-04 7.33e-08  1.18e-03   246s
  57   4.47462438e+03  3.12610653e+03  5.79e-04 6.28e-08  9.79e-04   248s
  58   4.44503391e+03  3.34277312e+03  5.10e-04 5.27e-08  8.00e-04   250s
  59   4.40961298e+03  3.48845318e+03  4.31e-04 4.48e-08  6.68e-04   253s
  60   4.37625536e+03  3.61915856e+03  3.60e-04 3.77e-08  5.49e-04   256s
  61   4.33672295e+03  3.66701178e+03  2.80e-04 3.51e-08  4.85e-04   258s
  62   4.31002708e+03  3.79202771e+03  2.26e-04 2.73e-08  3.75e-04   260s
  63   4.26841731e+03  3.89606133e+03  1.49e-04 3.02e-08  2.70e-04   263s
  64   4.24819241e+03  3.92995899e+03  1.14e-04 3.18e-08  2.30e-04   265s
  65   4.23651897e+03  3.98349580e+03  9.24e-05 3.08e-08  1.83e-04   267s
  66   4.22578884e+03  3.99882415e+03  7.51e-05 3.06e-08  1.64e-04   269s
  67   4.21395454e+03  4.02378370e+03  5.58e-05 3.18e-08  1.38e-04   272s
  68   4.19982124e+03  4.07595411e+03  3.44e-05 3.51e-08  8.95e-05   274s
  69   4.19248880e+03  4.08804509e+03  2.38e-05 3.50e-08  7.55e-05   277s
  70   4.18669746e+03  4.11549566e+03  1.66e-05 2.53e-08  5.14e-05   279s
  71   4.18185931e+03  4.13381506e+03  1.05e-05 2.34e-08  3.47e-05   282s
  72   4.17851716e+03  4.14797254e+03  6.16e-06 2.12e-08  2.21e-05   284s
  73   4.17562550e+03  4.15778613e+03  2.81e-06 1.95e-08  1.29e-05   287s
  74   4.17429088e+03  4.16160428e+03  1.47e-06 1.85e-08  9.17e-06   289s
  75   4.17400574e+03  4.16373899e+03  1.19e-06 1.82e-08  7.43e-06   291s
  76   4.17348654e+03  4.16563680e+03  7.08e-07 1.88e-08  5.69e-06   293s
  77   4.17315541e+03  4.16744768e+03  3.80e-07 1.91e-08  4.15e-06   295s
  78   4.17301040e+03  4.16979109e+03  2.63e-07 1.86e-08  2.35e-06   297s
  79   4.17274540e+03  4.17082366e+03  1.03e-07 1.67e-08  1.41e-06   299s
  80   4.17264684e+03  4.17125051e+03  5.13e-08 1.61e-08  1.03e-06   301s
  81   4.17261673e+03  4.17150175e+03  3.78e-08 1.55e-08  8.28e-07   303s
  82   4.17258696e+03  4.17168643e+03  2.53e-08 1.52e-08  6.74e-07   306s
  83   4.17256609e+03  4.17173662e+03  1.95e-08 1.63e-08  6.27e-07   309s
  84   4.17255131e+03  4.17204129e+03  1.51e-08 1.64e-08  4.00e-07   313s
  85   4.17254111e+03  4.17225795e+03  1.25e-08 1.63e-08  2.37e-07   316s
  86   4.17250503e+03  4.17236443e+03  4.89e-09 1.67e-08  1.41e-07   319s
  87   4.17249849e+03  4.17243609e+03  3.45e-09 1.66e-08  8.56e-08   322s
  88   4.17249684e+03  4.17244337e+03  3.24e-09 1.66e-08  7.93e-08   327s
  89   4.17249590e+03  4.17244888e+03  3.11e-09 1.61e-08  7.35e-08   331s
  90   4.17249553e+03  4.17245225e+03  3.05e-09 1.52e-08  6.82e-08   334s
  91   4.17249413e+03  4.17246442e+03  2.53e-09 9.62e-09  4.42e-08   337s
  92   4.17248830e+03  4.17246789e+03  1.18e-09 8.30e-09  3.42e-08   340s
  93   4.17248721e+03  4.17247102e+03  1.45e-09 7.17e-09  2.83e-08   343s
  94   4.17248465e+03  4.17247528e+03  3.94e-09 5.20e-09  1.78e-08   345s
  95   4.17248285e+03  4.17247928e+03  2.19e-07 4.14e-09  1.02e-08   348s
  96   4.17248248e+03  4.17247934e+03  1.59e-07 4.00e-09  9.42e-09   351s
  97   4.17248233e+03  4.17247948e+03  1.35e-07 3.63e-09  7.96e-09   353s
  98   4.17248190e+03  4.17247967e+03  3.45e-08 3.04e-09  5.39e-09   355s
  99   4.17248177e+03  4.17247992e+03  2.84e-08 2.62e-09  3.88e-09   358s
 100   4.17248171e+03  4.17248032e+03  2.45e-08 2.59e-09  2.09e-09   360s
 101   4.17248149e+03  4.17247970e+03  1.14e-08 2.60e-09  5.90e-10   362s
 102   4.17248143e+03  4.17248024e+03  7.96e-09 2.60e-09  2.02e-10   365s
 103   4.17248141e+03  4.17248027e+03  7.12e-09 2.60e-09  1.81e-10   367s
 104   4.17248140e+03  4.17248071e+03  6.78e-09 2.60e-09  1.26e-10   369s
 105   4.17248128e+03  4.17248116e+03  3.53e-09 2.60e-09  2.11e-11   372s

Barrier solved model in 105 iterations and 372.23 seconds
Optimal objective 4.17248128e+03


Root crossover log...

   64349 DPushes remaining with DInf 0.0000000e+00               373s
     749 DPushes remaining with DInf 0.0000000e+00               375s
       0 DPushes remaining with DInf 1.6719464e-05               377s

     917 PPushes remaining with PInf 1.7778509e+05               377s
       6 PPushes remaining with PInf 6.4122693e+04               377s

  Push phase complete: Pinf 6.4122693e+04, Dinf 9.8510802e-01    377s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23119    3.8950303e+03   0.000000e+00   6.391390e+00    378s
   24998    3.8948521e+03   0.000000e+00   5.065090e+02    380s
   29287    3.8946035e+03   0.000000e+00   3.743072e+03    385s
   34060    3.8943812e+03   0.000000e+00   3.401970e+02    390s
   39781    3.8940563e+03   0.000000e+00   1.079249e+02    395s
   44482    3.8938588e+03   0.000000e+00   6.478717e+01    400s
   49040    3.8945679e+03   2.149667e+04   0.000000e+00    406s
   50956    3.8964670e+03   5.977766e+04   0.000000e+00    411s
   52888    3.8976542e+03   5.090022e+04   0.000000e+00    416s
   55786    3.8985012e+03   2.492530e+03   0.000000e+00    422s
   56752    3.8985967e+03   0.000000e+00   0.000000e+00    425s
   58105    3.8982985e+03   0.000000e+00   0.000000e+00    428s
   59282    3.8974380e+03   0.000000e+00   7.013977e+03    431s
   64469    3.8968658e+03   0.000000e+00   3.631581e+02    435s
   69092    3.8967845e+03   0.000000e+00   2.105020e-01    440s
   70397    3.8982265e+03   0.000000e+00   0.000000e+00    445s
   70420    3.8982260e+03   0.000000e+00   0.000000e+00    446s
Extra 12315 simplex iterations after uncrush
Concurrent spin time: 0.06s

Solved with barrier

Root relaxation: objective 3.898226e+03, 70420 iterations, 372.96 seconds

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3898.22599    0    2          - 3898.22599      -     -  446s
H    0     0                    3898.2334889 3898.22599  0.00%     -  449s

Explored 1 nodes (70420 simplex iterations) in 450.90 seconds
Thread count was 8 (of 8 available processors)

Solution count 1: 3898.23 

Optimal solution found (tolerance 2.00e-03)
Warning: max constraint violation (7.9710e-02) exceeds tolerance
Warning: max bound violation (7.1099e-02) exceeds tolerance
Best objective 3.898233488906e+03, best bound 3.898233488906e+03, gap 0.0000%
the solution is feasible and optimal
Solution time: 502.93179059028625
Done solving model.
Time used solving the model: 702.0774459838867
----------Dumping data in pickle file...done.
Dumping results in pickle file.....done.
objective function value:  3898.2334889056324
objective function value normalized (BILLION NOK):  3898.23
                      2023     2028      2034      2040      2050     
                      mean std mean  std mean  std mean  std mean  std
General                 43   0   57    0   64  1.8   67  1.8   73  2.1
General (Empty Trips)   48   0   14    0   14 0.64   15 0.55   15 0.57
Carbon                 4.2   0  6.7    0  4.4 0.02  2.3 0.04 0.86    1
Carbon (Empty Trips)    16   0  1.2    0 0.36 0.02  0.1 0.04 0.19 0.27
Time value              15   0   18    0   22 0.02   23 0.02   27 0.04
Transfer                22   0   29    0   34 0.07   31 0.04   33 0.29
Edge                   1.4   0    0    0    0    0    0    0    0    0
Node                  0.47   0 0.21    0    0    0 0.03 0.01    0    0
Upgrade                  0   0    0    0    0    0    0    0    0    0
Charge                 4.7   0  4.5    0  3.6    0  4.5    0  3.1    0
discount_factor          1   1 0.83 0.83 0.66 0.66 0.53 0.53 0.36 0.36
emissions (MTonnes CO2 eq.):
             AvgEmission    Std  AvgEmission_perc  Std_perc
time_period                                                
2023                  32      0             1e+02         0
2028                 4.7      0                14         0
2034                 2.2 0.0051               6.9     0.016
2040                 1.1  0.011               3.4     0.034
2050                0.53   0.63               1.6       1.9
----------------
Average transport work in GTONNES*km:
    mode            product time_period  TransportArbeid
0   Rail  Break bulk (slow)        2023                0
1   Rail           Dry bulk        2023               11
2   Rail           Neo bulk        2023         -0.00011
3   Road  Break bulk (fast)        2023              5.9
4   Road  Break bulk (slow)        2023              6.5
5   Road   Container (fast)        2023              2.7
6   Road   Container (slow)        2023              3.5
7   Road           Dry bulk        2023             0.57
8   Road           Neo bulk        2023               12
9    Sea  Break bulk (fast)        2023             0.12
10   Sea  Break bulk (slow)        2023              1.4
11   Sea   Container (fast)        2023             0.15
12   Sea   Container (slow)        2023              1.3
13   Sea           Dry bulk        2023               99
14   Sea           Neo bulk        2023              0.3

